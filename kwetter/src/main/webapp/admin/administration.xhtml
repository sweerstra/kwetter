<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Administration Panel</title>
    <h:outputStylesheet name="css/style.css"/>
    <h:outputStylesheet name="css/administration.css"/>
</h:head>

<h:body>
    <div class="administration">
        <div class="users__list">
            <div class="administration__users__header">
                <h1>Users</h1>

                <h:form id="user-form">
                    <p:growl id="add-user" showDetail="true"/>

                    <p:inputText type="text" value="#{userBean.username}" placeholder="Username"/>
                    <p:inputText type="password" value="#{userBean.password}" placeholder="Password"/>

                    <p:commandButton value="Add" update="@all"
                                     actionListener="#{usersBean.addUser(userBean.username, userBean.password, userBean.role)}"/>
                </h:form>

                <h:form id="user-groups-form">
                    <p:growl id="choose-role" showDetail="true"/>

                    <h:outputText value="User: "/>
                    <p:selectBooleanCheckbox value="#{userBean.userRole}">
                        <f:attribute name="group" value="user"/>
                        <p:ajax update="choose-role" listener="#{usersBean.onUserGroupEdit}"/>
                    </p:selectBooleanCheckbox>

                    <h:outputText value="Moderator: "/>
                    <p:selectBooleanCheckbox value="#{userBean.moderatorRole}">
                        <f:attribute name="group" value="moderator"/>
                        <p:ajax update="choose-role" listener="#{usersBean.onUserGroupEdit}"/>
                    </p:selectBooleanCheckbox>

                    <h:outputText value="Admin: "/>
                    <p:selectBooleanCheckbox value="#{userBean.adminRole}">
                        <f:attribute name="group" value="admin"/>
                        <p:ajax update="choose-role" listener="#{usersBean.onUserGroupEdit}"/>
                    </p:selectBooleanCheckbox>

                    <p:commandButton value="Update" update="@all" actionListener="#{usersBean.onSaveUser}"/>
                </h:form>
            </div>

            <h:form id="users-form">
                <p:growl id="role-update" showDetail="true"/>

                <p:dataTable var="user" selectionMode="single" rowKey="#{user.id}" value="#{usersBean.users}">
                    <p:ajax event="rowSelect" listener="#{usersBean.selectUser}"
                            update="@all"/>

                    <p:column headerText="Id">
                        <h:outputText value="#{user.id}"/>
                    </p:column>

                    <p:column headerText="Username">
                        <h:outputText value="#{user.username}"/>
                    </p:column>
                </p:dataTable>
            </h:form>
        </div>

        <div class="kweets__list">
            <div class="administration__kweets__header">
                <h1>Kweets</h1>
            </div>

            <h:form id="kweets-form">
                <p:growl id="username-update" showDetail="true"/>

                <p:dataTable id="kweets-datatable" var="kweet" editable="true" editMode="cell"
                             value="#{kweetsBean.kweets}">
                    <p:ajax event="cellEdit" listener="#{kweetsBean.onTextCellEdit}"
                            update=":kweets-form:username-update"/>

                    <p:column headerText="Id">
                        <h:outputText value="#{kweet.id}"/>
                    </p:column>

                    <p:column headerText="Text">
                        <p:cellEditor>
                            <f:facet name="output"> <h:outputText value="#{kweet.text}"/></f:facet>
                            <f:facet name="input"><p:inputText value="#{kweet.text}"/></f:facet>
                        </p:cellEditor>
                    </p:column>

                    <p:column headerText="User">
                        <h:outputText value="#{kweet.user.username}"/>
                    </p:column>

                    <p:column headerText="Date">
                        <h:outputText value="#{kweet.date.toLocaleString()}"/>
                    </p:column>

                    <p:column>
                        <p:commandButton value="Remove" actionListener="#{kweetsBean.removeKweet(kweet)}"
                                         style="width: 100%;" ajax="false"/>
                    </p:column>
                </p:dataTable>
            </h:form>
        </div>
    </div>
</h:body>

</html>